var siteUrl="/portale/P5603398863",calenders=[],events=[],calendarEl=document.getElementById("Kalender"),calendar=new FullCalendar.Calendar(calendarEl,{initialView:"dayGridMonth",weekNumbers:!0,locale:"de",headerToolbar:{start:"prev,next today",center:"title",end:"dayGridMonth,multiMonthYear,listYear"},eventClick:function(event){if(event.url)return window.open(event.url,"_blank"),!1}});function Load_KalenderList(){var clientContext=new SP.ClientContext(siteUrl),oList=clientContext.get_web().get_lists().getByTitle("Liste_Kalender"),camlQuery=new SP.CamlQuery;camlQuery.set_viewXml('<View><Query><Where></Where><OrderBy><FieldRef Name="Prio" Ascending="FALSE" /></OrderBy></Query><RowLimit>50</RowLimit></View>'),this.collListItem=oList.getItems(camlQuery),clientContext.load(collListItem),clientContext.executeQueryAsync((function(){for(var listItemEnumerator=collListItem.getEnumerator();listItemEnumerator.moveNext();){var oListItem=listItemEnumerator.get_current();if(oListItem.get_item("Enable")){var data={};if(data.guid=oListItem.get_item("GUID0"),data.Title=oListItem.get_item("Title"),data.URL=oListItem.get_item("URL").get_url(),data.Background_Color=oListItem.get_item("Background_Color"),data.Font_Color=oListItem.get_item("Font_Color"),data.Active=oListItem.get_item("Active_onStart"),data.group=oListItem.get_id(),data.display=oListItem.get_item("Display"),data.Display_Context=oListItem.get_item("Display_Context"),data.URL.toString().includes("/Lists/")){var url_arr=data.URL.split("/Lists/"),site_arr=url_arr[0].split("/");data.siteUrl="/"+site_arr[site_arr.length-2]+"/"+site_arr[site_arr.length-1]+"/",data.list_name=url_arr[1].split("/")[0],calenders.push(data),Load_Kalender(data),Display_Context(data)}}}}),(function(sender,args){alert("Laden der Kalender Informationen fehlgeschlagen: "+args.get_message()+"\n"+args.get_stackTrace())}))}function Load_Kalender(data){var clientContext=new SP.ClientContext(data.siteUrl),oList=clientContext.get_web().get_lists().getByTitle(data.list_name),query="",camlQuery=new SP.CamlQuery;query+="<View><Query><Where>",query+="</Where>",query+='<OrderBy><FieldRef Name="EventDate" Ascending="True" /></OrderBy>',query+="</Query><RowLimit>0</RowLimit></View>",camlQuery.set_viewXml(query);var collListItem=oList.getItems(camlQuery);clientContext.load(collListItem),clientContext.executeQueryAsync((function(){for(var listItemEnumerator=collListItem.getEnumerator();listItemEnumerator.moveNext();){var event={},oListItem=listItemEnumerator.get_current();event.id=data.list_name+"_"+oListItem.get_id(),event.title=oListItem.get_item("Title"),event.start=oListItem.get_item("EventDate").toISOString(),event.end=oListItem.get_item("EndDate").toISOString(),event.allDay=oListItem.get_item("fAllDayEvent"),event.description=oListItem.get_item("Location"),data.Active?event.display=data.display:event.display="none",""!=data.guid&&(event.url=data.siteUrl+"_layouts/15/Event.aspx?ListGuid="+data.guid+"&ItemId="+oListItem.get_id()),event.backgroundColor=data.Background_Color,event.textColor=data.Font_Color,event.extendedProps={list:data.list_name,default_display:data.display},console.info(event),calendar.addEvent(event,!0)}calendar.render()}),(function(sender,args){alert("Laden der Kalender Informationen fehlgeschlagen: "+args.get_message()+"\n"+args.get_stackTrace())}))}function Display_Context(data){var subclass="";data.Active&&(subclass=" c_active"),$("#context_"+data.Display_Context).append('<div id="context_'+data.list_name+'" onclick="Context_Toggle(this, \''+data.list_name+'\');" class="context_news_item'+subclass+'">'+data.Title+"</div>")}function Context_Toggle(item,list_name){var list_id=calenders.map(el=>el.list_name).indexOf(list_name);list_id<0||(calenders[list_id].Active?(calenders[list_id].Active=!1,$("#context_"+list_name).removeClass("c_active")):(calenders[list_id].Active=!0,$("#context_"+list_name).addClass("c_active")),Update_Events())}calendar.render(),Load_KalenderList();var search_str="";function Search(){var text=$("#context_tb_input").val();text.length>2?(search_str=text.toLowerCase(),Update_Events()):""!==search_str?(search_str="",Update_Events()):search_str=""}function Update_Events(){activ_data={},calenders.forEach(element=>{activ_data[element.list_name]=element.Active}),calendar.getEvents().forEach(event=>{var list_name=event.extendedProps.list,title=event.title,description=event.extendedProps.description;return null==description&&(description=""),title=title.toLowerCase(),description=description.toLowerCase(),activ_data[list_name]&&(""===search_str||title.includes(search_str)||description.includes(search_str))?(console.info("("+event.id+") "+title+" - Display => "+event.extendedProps.default_display),void event.setProp("display",event.extendedProps.default_display)):(event.setProp("display","none"),void console.info("("+event.id+") "+title+" - Display => none"))})}
//# sourceMappingURL=Kalender.min.js.map